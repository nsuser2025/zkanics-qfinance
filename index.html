<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>SFG Primer</title>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
window.MathJax = {
    tex: { 
        packages: {'[+]': ['ams']}, // amsmath を追加
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
    },
    options: { skipHtmlTags: ['script','style','textarea','pre'] },
    chtml: { matchFontHeight: false, displayAlign: "left", displayIndent: "2em" },
    loader: { load: ['[tex]/noerrors'] }
};
</script>

<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>

<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #note-container { 
        border: 1px solid #ccc; 
        padding: 15px; 
        margin-top: 20px; 
        background-color: #f9f9f9;
        min-height: 200px;
    }
</style>
</head>
<body>

<h1>SFG Primer</h1>

<label for="chapter-select">topics:</label>
<select id="chapter-select" onchange="loadMarkdown(this.value)">
    <option value="" disabled selected>--- 選択してください ---</option>
    <option value="chapter001">SFG分光法とは？</option>
    <option value="chapter002">赤外光と可視光を使う理由</option>
    <option value="chapter003">界面選択性の理論的背景</option>
    <option value="topics004">Appendix 分極ベクトルと分極電荷密度</option>
    <option value="topics005">Appendix 誘電体のGaussの法則</option>
</select>

<div id="note-container">
    <p>ファイルを選択すると、ここに内容が表示されます。</p>
</div>

<script>
    // ----------------------------------------------------------------------
    // NOTE: この行は、Pythonスクリプトによって実際のMarkdownデータが挿入されます。
    // 例: const allMarkdownData = {"chapter001": "# 第1章...", "chapter2": "...};
    // MARKDOWN_DATA_PLACEHOLDER
    // ----------------------------------------------------------------------

    // Marked.js のオプション設定
    marked.setOptions({
        breaks: true,
        gfm: true,
    });

    /**
     * Pythonから渡されたデータからMarkdownをロード
     * @param {string} key - 読み込むノートのキー (例: 'chapter001')
     */
    function loadMarkdown(key) {
        if (!key) return;

        const container = document.getElementById('note-container');

        // キーに対応するMarkdownコンテンツを取得
        const markdownText = allMarkdownData[key]; 
        
        if (!markdownText) {
             container.innerHTML = `<p style="color: red;"><strong>エラー: データが見つかりませんでした。</strong></p>`;
             return;
        }

        // HTMLに変換
        container.innerHTML = marked.parse(markdownText);
        
        // MathJaxに数式の再レンダリングを要求
        MathJax.typesetPromise([container]);
    }
</script>

</body>
</html>
